# GitHub Actions Deployment Setup for WordPress Theme

This guide explains how to set up automated deployment for your WordPress theme using GitHub Actions.

**Fully Manual Workflow**: This configuration requires manual triggers for both builds and deployments - nothing happens automatically.

## üîß GitHub Actions Configuration

The `.github/workflows/deploy.yml` file includes:

- **Manual Build**: Compiles Vite assets (SCSS, JS) when manually triggered
- **Manual Deploy**: Manual deployment to production server
- **Manual Rollback**: Manual rollback functionality

## üìã Prerequisites

1. GitHub repository with Actions enabled
2. SSH access to your web server
3. SSH private key for authentication

## ‚öôÔ∏è Setup Instructions

### 1. Configure GitHub Secrets

Go to your GitHub repository: **Settings > Secrets and variables > Actions**

Add the following secret:

| Secret Name       | Value                        |
| ----------------- | ---------------------------- |
| `SSH_PRIVATE_KEY` | Your SSH private key content |

**To get your SSH private key content:**

```bash
# On your local machine (WSL/Linux)
cat ~/.ssh/nazwa-wet
```

Copy the entire content including `-----BEGIN OPENSSH PRIVATE KEY-----` and `-----END OPENSSH PRIVATE KEY-----`

### 2. Server Configuration

The Actions workflow is configured to deploy to:

- **Host**: `wet19.nazwa.pl`
- **User**: `wet19`
- **Path**: `domains/fajnestarocie.pl/public_html/wp-content/themes/fajnestarocie`

### 3. Branch Strategy

- **Any branch**: Manual build and deployment available (workflow_dispatch)
- **Recommended**: Use only on `main`/`master` branch

## üöÄ Deployment Process

### Manual Workflow Trigger

1. Go to your GitHub repository: **Actions tab**
2. Select "WordPress Theme Deployment" workflow
3. Click "Run workflow" button
4. Choose your options:
   - **Environment**: production
   - **Action**: build-only, deploy, or rollback

### Available Actions

#### **Build Only**

- Compiles Vite assets
- Creates build artifacts
- No deployment

#### **Deploy**

- Runs build first
- Deploys to production server
- Includes compiled assets

#### **Rollback**

- Restores previous version
- No build required

## üìÅ Files Excluded from Deployment

The following files/directories are automatically excluded:

- `node_modules/`
- `.git/`, `.github/`
- `package.json`, `package-lock.json`
- `temp/`
- `.gitignore`, `*.md`
- `.env*`, `.vscode/`, `.idea/`
- `*.log`, `.DS_Store`

## üìÅ Files Included in Deployment

- All PHP theme files
- `src/` (source files)
- `dist/` (compiled assets)
- `public/` (static assets)
- `style.css`
- `screenshot.png`
- `languages/`
- `woocommerce/`
- `template-parts/`
- `page-templates/`
- `inc/`
- Configuration files: `vite.config.js`, `postcss.config.js`, `tailwind.config.js`

## üîÑ Rollback Process

If you need to rollback a deployment:

1. Go to GitHub: **Actions tab**
2. Click "Run workflow"
3. Select **Action**: "rollback"
4. The system will restore the previous version

## üêõ Troubleshooting

### SSH Connection Issues

- Verify SSH key is correctly added to GitHub Secrets
- Check server SSH access
- Ensure key has proper permissions on server

### Build Failures

- Check `package.json` dependencies
- Verify Vite configuration
- Review build logs in GitHub Actions

### Deployment Issues

- Verify server paths are correct
- Check file permissions on server
- Ensure sufficient disk space

## üìù Customization

### Change Deployment Path

Edit the `REMOTE_THEME_PATH` variable in `.github/workflows/deploy.yml`:

```yaml
env:
  REMOTE_THEME_PATH: 'your/custom/path/wp-content/themes/your-theme'
```

### Add Additional Excludes

Add more exclude patterns in the rsync command:

```yaml
--exclude='your-file-pattern' \
```

### Modify Build Process

Change the build commands in the build job:

```yaml
- name: Build assets
  run: |
    npm ci
    npm run your-custom-build-command
```

## üîí Security Notes

- SSH private key is stored as encrypted GitHub Secret
- **Fully manual workflow** prevents any accidental builds or releases
- All sensitive data should be in GitHub Secrets
- No `--delete` flag used for safer deployments
- SSH keys are cleaned up after each job

## üìû Support

If you encounter issues:

1. Check GitHub Actions logs
2. Verify server connectivity
3. Test SSH access manually
4. Review file permissions on server

## üîÑ Workflow Examples

### Quick Deploy

1. **Actions** ‚Üí **Run workflow**
2. Action: **deploy**
3. Monitor progress in Actions tab

### Safe Testing

1. **Actions** ‚Üí **Run workflow**
2. Action: **build-only**
3. Check build artifacts

### Emergency Rollback

1. **Actions** ‚Üí **Run workflow**
2. Action: **rollback**
3. Confirm previous version restored
